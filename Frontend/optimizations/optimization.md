# Улучшение производительности приложения, интерфейса

https://www.patterns.dev/vanilla/
https://roadmap.sh/best-practices/frontend-performance

## ОСНОВНЫЕ НАПРАВЛЕНИЯ ДЛЯ ОПТИМИЗАЦИИ
- Уменьшаем кол-во `iframes` - iframe неплохо так нагружает нашь сайт;
- Используйте `HTTPS`;
- `Время загрузки страницы` < 3секунд
- Контролируйте вес нашей страницы:
  - `идеальный вариант` < 500КБ
  - `средний вариант` < 1500КБ
- Минимизируйте HTTP-запросы - не запрашивайте данные, которые пока что не нужны, их всегда можно подгрузить;
- Кэшируйте контент с помощью `HTTP headers`;
- Используйте метод сжатия контента `Gzip`, `Brotli`;

### CSS
- Minify CSS;
- Недопускать ошибки в CSS;
- Загружать неблокирующе рендер CSS `<link rel="preload" href="css/global.min.css" as="style" onload="this.rel='stylesheet'">`, чтоб сначало отрендарилось, а после того прийдет CSS перендарилось;

### JS
- Minify JS;
- Неблокировать `First Paint` загрузкой и компиляцией JS - использовать `async` и `defer`
  - `async` - абсолютно независимый скрипт - сам по себе;
  - `defer` - неблокирующий скрипт, который обладает свойствами обычной загрузки скрипта;
  - https://tokmakov.msk.ru/blog/item/701
  - https://developers.google.com/speed/docs/insights/v5/get-started?hl=ru
- Использовать `Lazy Loading` - пока JS код не будет использовать он не будет подгружен;

#### Место defer и async в загрузки сайтов
1. Парсинг;
2. Загрузка контента;
3. Блокирующий контент загрузился:
4. Рендер;
5. Все `Defer` скрипты загрузился и выполнился;
6. `DOMContentLoaded`
7. `Async` загрузился и выполнился:

#### Defer
Неблокирующий js: 
- Выполняется всегда после того, как будет готово DOM дерево;
- `DOMContentLoaded` срабатывает после загрузки всех `defer` скриптов;
- Код для разных `defer` скриптов выполняется в порядке относительно друг друга:

Хотя 1-ым загрузится `./small.js`, он выполнится только после того, как `./long.js` загрузится и выполнится

```html
<script defer src="./long.js"></script>
<script defer src="./small.js"></script>
```

#### Async
Неблокирующий js, который максимально не зависим - сам по себе. Может выполнится в любое время.

### HTML
- Добавлять только необходимые стили в `<html><style> ... </style></html>`;
- Недопускать ошибки в HTML;

### Картинки/Контент
- Оптимизация изображений - сжатие и т.д.;
- Подгружать картинки, только когда они нужны - будут в поле видимости;
- Подгружать `основные картинки`, которые понадобятся через некоторое время через `rel="preload"` - это необходимо чтоб картинки уже сразуже подгружены были;

## ОПТИМИЗАЦИИ СРЕДНЕГО ПРИОРИТЕТА
- Используйте `Content Delivery Network - CDN`;
- Используйте кэширование в `Service Worker`;

## JS
- Проверяйте на производительность JS код - профилируйте;


### Картинки/Контент
- Используйте `svg` картинки вместо растровых;
- Не используйте `Base64` картинки;
- Используйте адаптивные изображения - в зависимости от верстки будет загружатся разные варианты размеров изображения 50x50 или 500x500;

## ОПТИМИЗАЦИЯ НИЗКОГО ПРИОРИТЕТА
- Загружайте контент в фоне, который понадобится потом `<link rel="preload" as="image" href="public/logo.png" />`
- Используйте шрифт `WOFF 2.0`;
- Шрифт < 300КБ;
- Проверяйте размер используемой JS библиотеки и используйте Tree shaking;